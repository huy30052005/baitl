<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Qu·∫£n l√Ω ho√†n ti·ªÅn - SellerHub</title>
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/forms.css" />
    <style>
      /* B·∫¢O V·ªÜ TRI·ªÜT ƒê·ªÇ - ƒê·∫£m b·∫£o sidebar v√† main lu√¥n hi·ªÉn th·ªã */
      html, body {
        width: 100% !important;
        height: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
      }
      
      .app {
        display: flex !important;
        width: 100% !important;
        height: 100vh !important;
        overflow: hidden !important;
        position: relative !important;
      }
      
      .sidebar {
        display: flex !important;
        width: 230px !important;
        min-width: 230px !important;
        max-width: 230px !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        flex-shrink: 0 !important;
      }
      
      .main {
        display: flex !important;
        flex: 1 !important;
        width: auto !important;
        min-width: 0 !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        flex-shrink: 1 !important;
      }
      
      /* Override m·ªçi style inline c√≥ th·ªÉ ·∫©n main */
      .main[style*="display: none"],
      .main[style*="display:none"] {
        display: flex !important;
      }
      
      .sidebar[style*="display: none"],
      .sidebar[style*="display:none"] {
        display: flex !important;
      }
      
      .app[style*="display: none"],
      .app[style*="display:none"] {
        display: flex !important;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <!-- SIDEBAR -->
      <aside class="sidebar">
        <div class="sidebar-header top-brand">
          <div class="brand-left">
            <div class="brand-icon">üõí</div>
            <div class="brand-text">
              <div class="brand-name">SellerHub</div>
            </div>
          </div>
          <button class="collapse-btn">‚Æü</button>
        </div>

        <div class="sidebar-scroll">
          <!-- QU·∫¢N L√ù -->
          <div class="sidebar-section-label">QU·∫¢N L√ù</div>
          <nav class="sidebar-nav">
            <a href="index.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üìä</span>
                <span class="nav-text">T·ªïng quan</span>
              </div>
            </a>

            <a href="sanpham-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üì¶</span>
                <span class="nav-text">S·∫£n ph·∫©m</span>
              </div>
            </a>

            <a href="danhmuc-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üóÇ</span>
                <span class="nav-text">Danh m·ª•c</span>
              </div>
            </a>

            <a href="tonkho-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üè¨</span>
                <span class="nav-text">T·ªìn kho</span>
              </div>
            </a>

            <a href="donhang-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üßæ</span>
                <span class="nav-text">ƒê∆°n h√†ng</span>
              </div>
            </a>

            <a href="khachhang-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üë•</span>
                <span class="nav-text">Kh√°ch h√†ng</span>
              </div>
            </a>

          </nav>

          <!-- V·∫¨N H√ÄNH -->
          <div class="sidebar-section-label">V·∫¨N H√ÄNH</div>
          <nav class="sidebar-nav">
            <a href="vanchuyen-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üöö</span>
                <span class="nav-text">V·∫≠n chuy·ªÉn</span>
              </div>
            </a>
            <a href="hoantien-full.html" class="nav-item active">
              <div class="nav-left">
                <span class="nav-icon">‚Ü©Ô∏è</span>
                <span class="nav-text">Ho√†n ti·ªÅn</span>
              </div>
            </a>
            <a href="khuyenmai-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üè∑</span>
                <span class="nav-text">Khuy·∫øn m√£i</span>
              </div>
            </a>
            <a href="flashsale-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">‚ö°</span>
                <span class="nav-text">Flash Sale</span>
              </div>
            </a>
          </nav>

          <!-- PH√ÇN T√çCH -->
          <div class="sidebar-section-label">PH√ÇN T√çCH</div>
          <nav class="sidebar-nav">
            <a href="baocao-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üìà</span>
                <span class="nav-text">B√°o c√°o</span>
              </div>
            </a>
          </nav>

          <!-- THI·∫æT L·∫¨P -->
          <div class="sidebar-section-label">THI·∫æT L·∫¨P</div>
          <nav class="sidebar-nav">
            <a href="cuahang-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">üè™</span>
                <span class="nav-text">C·ª≠a h√†ng</span>
              </div>
            </a>
            <a href="caidat-full.html" class="nav-item">
              <div class="nav-left">
                <span class="nav-icon">‚öô</span>
                <span class="nav-text">C√†i ƒë·∫∑t</span>
              </div>
            </a>
          </nav>
        </div>

        <div class="sidebar-footer">
          <div class="user">
            <div class="avatar"><span>NH</span></div>
            <div class="user-info">
              <div class="user-name">Nguy·ªÖn Ho√†ng</div>
              <div class="user-role small">Premium Seller ‚ñæ</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <main class="main">
        <header class="topbar">
          <div class="topbar-left">
            <h1 class="page-title">Qu·∫£n l√Ω ho√†n ti·ªÅn</h1>
            <div class="search-box">
              <span class="search-icon">üîç</span>
              <input type="text" class="search-input" id="refundSearch" placeholder="T√¨m ki·∫øm m√£ y√™u c·∫ßu, kh√°ch h√†ng..." />
            </div>
          </div>
          <div class="topbar-right">
            <button class="top-btn">üîî</button>
            <button class="top-btn">‚ùì</button>
            <button class="btn-store-open">C·ª≠a h√†ng ƒëang m·ªü</button>
          </div>
        </header>

        <!-- SUMMARY CARDS -->
        <section class="kpi-row">
          <div class="kpi-card">
            <div class="kpi-header">
              <span>‚è∞ Ch·ªù x·ª≠ l√Ω</span>
            </div>
            <div class="kpi-value">1</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-header">
              <span>üîÑ ƒêang x·ª≠ l√Ω</span>
            </div>
            <div class="kpi-value">2</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-header">
              <span>‚úÖ ƒê√£ ho√†n ti·ªÅn</span>
            </div>
            <div class="kpi-value">32M</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-header">
              <span>‚ùå T·ª´ ch·ªëi</span>
            </div>
            <div class="kpi-value">1</div>
          </div>
        </section>

        <!-- TABS AND FILTERS -->
        <div class="product-header" style="margin-top: 20px;">
          <div class="filter-group">
            <div class="tabs">
              <button class="tab-btn active">T·∫•t c·∫£</button>
              <button class="tab-btn">Ch·ªù x·ª≠ l√Ω</button>
              <button class="tab-btn">ƒêang x·ª≠ l√Ω</button>
              <button class="tab-btn">ƒê√£ ho√†n</button>
            </div>
            <div style="display: flex; gap: 12px; align-items: center;">
              <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="refundSearchFilter" placeholder="T√¨m m√£ y√™u c·∫ßu, ƒë∆°n h√†ng..." />
              </div>
              <button class="btn-submit" id="exportReportBtn" style="white-space: nowrap;">
                üì• Xu·∫•t b√°o c√°o
              </button>
            </div>
          </div>
        </div>

        <!-- REFUND TABLE -->
        <div class="card">
          <div class="card-body table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>M√É Y√äU C·∫¶U</th>
                  <th>KH√ÅCH H√ÄNG</th>
                  <th>S·∫¢N PH·∫®M</th>
                  <th>L√ù DO</th>
                  <th>S·ªê TI·ªÄN</th>
                  <th>TR·∫†NG TH√ÅI</th>
                  <th>THAO T√ÅC</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>#HT-001</td>
                  <td>
                    <div class="product-cell">
                      <div class="avatar" style="width: 32px; height: 32px;"><span>TA</span></div>
                      <div class="product-info">
                        <div class="product-name">Tr·∫ßn VƒÉn A</div>
                        <div class="product-meta">0912 345 678</div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="product-cell">
                      <img src="https://picsum.photos/seed/iphone15/100/100" alt="iPhone 15 Pro Max" class="product-thumb" onerror="this.src='https://via.placeholder.com/40/1a1a2e/ffffff?text=IP'" />
                      <div class="product-info">
                        <div class="product-name">iPhone 15 Pro Max 25...</div>
                        <div class="product-meta">S·ªë l∆∞·ª£ng: 1</div>
                      </div>
                    </div>
                  </td>
                  <td style="max-width: 300px;">
                    <div>S·∫£n ph·∫©m b·ªã l·ªói m√†n h√¨nh, 1 h√¨nh ·∫£nh ƒë√≠nh k√®m</div>
                  </td>
                  <td><span style="font-weight: 600;">34.990.000‚Ç´</span></td>
                  <td><span class="status pending">Ch·ªù x·ª≠ l√Ω</span></td>
                  <td class="cell-right">
                    <div class="action-menu">
                      <button class="action-toggle">‚ãØ</button>
                      <div class="action-dropdown">
                        <button class="action-item" data-action="view" data-refund-id="HT-001">üëÅ Xem chi ti·∫øt</button>
                        <button class="action-item" data-action="approve" data-refund-id="HT-001">‚úÖ Duy·ªát ho√†n ti·ªÅn</button>
                        <button class="action-item danger" data-action="reject" data-refund-id="HT-001">‚ùå T·ª´ ch·ªëi</button>
                        <button class="action-item" data-action="message" data-refund-id="HT-001">üí¨ Nh·∫Øn tin</button>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>#HT-002</td>
                  <td>
                    <div class="product-cell">
                      <div class="avatar" style="width: 32px; height: 32px;"><span>NB</span></div>
                      <div class="product-info">
                        <div class="product-name">Nguy·ªÖn Th·ªã B</div>
                        <div class="product-meta">0987 654 321</div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="product-cell">
                      <img src="https://picsum.photos/seed/airpods/100/100" alt="AirPods Pro 2" class="product-thumb" onerror="this.src='https://via.placeholder.com/40/1a1a2e/ffffff?text=AP'" />
                      <div class="product-info">
                        <div class="product-name">AirPods Pro 2</div>
                        <div class="product-meta">S·ªë l∆∞·ª£ng: 1</div>
                      </div>
                    </div>
                  </td>
                  <td>S·∫£n ph·∫©m kh√¥ng ƒë√∫ng m√¥...</td>
                  <td><span style="font-weight: 600;">6.490.000‚Ç´</span></td>
                  <td><span class="status success">ƒê√£ duy·ªát</span></td>
                  <td class="cell-right">
                    <div class="action-menu">
                      <button class="action-toggle">‚ãØ</button>
                      <div class="action-dropdown">
                        <button class="action-item" data-action="view" data-refund-id="HT-002">üëÅ Xem chi ti·∫øt</button>
                        <button class="action-item" data-action="message" data-refund-id="HT-002">üí¨ Nh·∫Øn tin</button>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>#HT-003</td>
                  <td>
                    <div class="product-cell">
                      <div class="avatar" style="width: 32px; height: 32px;"><span>LC</span></div>
                      <div class="product-info">
                        <div class="product-name">L√™ Ho√†ng C</div>
                        <div class="product-meta">0909 123 456</div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="product-cell">
                      <img src="https://picsum.photos/seed/macbook/100/100" alt="MacBook Air M3" class="product-thumb" onerror="this.src='https://via.placeholder.com/40/1a1a2e/ffffff?text=MB'" />
                      <div class="product-info">
                        <div class="product-name">MacBook Air M3</div>
                        <div class="product-meta">S·ªë l∆∞·ª£ng: 1</div>
                      </div>
                    </div>
                  </td>
                  <td>ƒê·ªïi √Ω, kh√¥ng mu·ªën mua n·ªØa</td>
                  <td><span style="font-weight: 600;">27.990.000‚Ç´</span></td>
                  <td><span class="status cancelled">T·ª´ ch·ªëi</span></td>
                  <td class="cell-right">
                    <div class="action-menu">
                      <button class="action-toggle">‚ãØ</button>
                      <div class="action-dropdown">
                        <button class="action-item" data-action="view" data-refund-id="HT-003">üëÅ Xem chi ti·∫øt</button>
                        <button class="action-item" data-action="message" data-refund-id="HT-003">üí¨ Nh·∫Øn tin</button>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>#HT-004</td>
                  <td>
                    <div class="product-cell">
                      <div class="avatar" style="width: 32px; height: 32px;"><span>PD</span></div>
                      <div class="product-info">
                        <div class="product-name">Ph·∫°m Minh D</div>
                        <div class="product-meta">0978 111 222</div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="product-cell">
                      <img src="https://picsum.photos/seed/watch/100/100" alt="Apple Watch Ultra 2" class="product-thumb" onerror="this.src='https://via.placeholder.com/40/1a1a2e/ffffff?text=AW'" />
                      <div class="product-info">
                        <div class="product-name">Apple Watch Ultra 2</div>
                        <div class="product-meta">S·ªë l∆∞·ª£ng: 1</div>
                      </div>
                    </div>
                  </td>
                  <td>Giao nh·∫ßm s·∫£n ph·∫©m, 1 h√¨nh ·∫£nh ƒë√≠nh k√®m</td>
                  <td><span style="font-weight: 600;">21.990.000‚Ç´</span></td>
                  <td><span class="status" style="background: rgba(59, 130, 246, 0.16); color: #3b82f6;">ƒêang x·ª≠ l√Ω</span></td>
                  <td class="cell-right">
                    <div class="action-menu">
                      <button class="action-toggle">‚ãØ</button>
                      <div class="action-dropdown">
                        <button class="action-item" data-action="view" data-refund-id="HT-004">üëÅ Xem chi ti·∫øt</button>
                        <button class="action-item" data-action="approve" data-refund-id="HT-004">‚úÖ Duy·ªát ho√†n ti·ªÅn</button>
                        <button class="action-item danger" data-action="reject" data-refund-id="HT-004">‚ùå T·ª´ ch·ªëi</button>
                        <button class="action-item" data-action="message" data-refund-id="HT-004">üí¨ Nh·∫Øn tin</button>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>#HT-005</td>
                  <td>
                    <div class="product-cell">
                      <div class="avatar" style="width: 32px; height: 32px;"><span>VE</span></div>
                      <div class="product-info">
                        <div class="product-name">V√µ Th·ªã E</div>
                        <div class="product-meta">0935 999 888</div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="product-cell">
                      <img src="https://picsum.photos/seed/ipad/100/100" alt="iPad Pro 12.9" class="product-thumb" onerror="this.src='https://via.placeholder.com/40/1a1a2e/ffffff?text=IP'" />
                      <div class="product-info">
                        <div class="product-name">iPad Pro 12.9</div>
                        <div class="product-meta">S·ªë l∆∞·ª£ng: 1</div>
                      </div>
                    </div>
                  </td>
                  <td>S·∫£n ph·∫©m b·ªã tr·∫ßy x∆∞·ªõc khL</td>
                  <td><span style="font-weight: 600;">31.990.000‚Ç´</span></td>
                  <td><span class="status success">ƒê√£ ho√†n ti·ªÅn</span></td>
                  <td class="cell-right">
                    <div class="action-menu">
                      <button class="action-toggle">‚ãØ</button>
                      <div class="action-dropdown">
                        <button class="action-item" data-action="view" data-refund-id="HT-005">üëÅ Xem chi ti·∫øt</button>
                        <button class="action-item" data-action="message" data-refund-id="HT-005">üí¨ Nh·∫Øn tin</button>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </main>
    </div>

    <!-- MODAL XEM CHI TI·∫æT HO√ÄN TI·ªÄN -->
    <div id="refundDetailModal" class="modal">
      <div class="modal-content" style="max-width: 800px;">
        <div class="modal-header">
          <div>
            <h2 id="refundDetailTitle">Chi ti·∫øt y√™u c·∫ßu ho√†n ti·ªÅn <span id="refundDetailCodeSpan">#HT-001</span></h2>
            <p class="modal-subtitle" id="refundDetailOrder">ƒê∆°n h√†ng: ƒêH-12340</p>
          </div>
          <button class="modal-close" id="closeRefundDetailModal">‚úï</button>
        </div>

        <div class="modal-body">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px;">
            <div style="padding: 16px; background: var(--bg-elevated-2); border-radius: 8px;">
              <h3 style="font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 12px;">Th√¥ng tin kh√°ch h√†ng</h3>
              <div id="refundDetailCustomer" style="display: flex; align-items: center; gap: 12px;">
                <!-- S·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn b·ªüi JS -->
              </div>
            </div>
            <div style="padding: 16px; background: var(--bg-elevated-2); border-radius: 8px;">
              <h3 style="font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 12px;">Th√¥ng tin s·∫£n ph·∫©m</h3>
              <div id="refundDetailProduct">
                <!-- S·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn b·ªüi JS -->
              </div>
            </div>
          </div>

          <div style="margin-bottom: 24px;">
            <h3 style="font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 12px;">L√Ω do ho√†n ti·ªÅn</h3>
            <div id="refundDetailReason" style="padding: 12px; background: var(--bg-elevated-2); border-radius: 8px; color: var(--text); min-height: 60px;">
              <!-- S·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn b·ªüi JS -->
            </div>
          </div>

          <div id="refundDetailImages" style="margin-bottom: 24px;">
            <h3 style="font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 12px;">H√¨nh ·∫£nh ƒë√≠nh k√®m</h3>
            <div id="refundDetailImagesContainer" style="display: flex; gap: 12px; flex-wrap: wrap;">
              <!-- S·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn b·ªüi JS -->
            </div>
          </div>

          <div id="refundDetailFeedback" style="margin-bottom: 24px;">
            <h3 style="font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 12px;">Ph·∫£n h·ªìi c·ªßa b·∫°n</h3>
            <textarea
              id="refundDetailFeedbackText"
              placeholder="Nh·∫≠p l√Ω do n·∫øu t·ª´ ch·ªëi..."
              rows="4"
              style="width: 100%; padding: 12px; background: var(--bg-elevated-2); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px; font-family: inherit; resize: vertical; outline: none; transition: border-color 0.2s;"
            ></textarea>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn-cancel" id="closeRefundDetailModalBtn">ƒê√≥ng</button>
          <button type="button" class="btn-cancel" id="rejectFromDetailBtn" style="color: #dc2626; border-color: rgba(220, 38, 38, 0.3);">T·ª´ ch·ªëi</button>
          <button type="button" class="btn-submit" id="approveFromDetailBtn">Duy·ªát ho√†n ti·ªÅn</button>
        </div>
      </div>
    </div>

    <!-- MODAL NH·∫ÆN TIN -->
    <div id="messageModal" class="modal">
      <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header">
          <div>
            <h2>Nh·∫Øn tin cho kh√°ch h√†ng</h2>
            <p class="modal-subtitle" id="messageCustomerName">Kh√°ch h√†ng: Tr·∫ßn VƒÉn A</p>
          </div>
          <button class="modal-close" id="closeMessageModal">‚úï</button>
        </div>

        <div class="modal-body">
          <div class="form-group">
            <label>N·ªôi dung tin nh·∫Øn</label>
            <textarea
              id="messageContent"
              placeholder="Nh·∫≠p n·ªôi dung tin nh·∫Øn..."
              rows="6"
              style="width: 100%; padding: 12px; background: var(--bg-elevated-2); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px; font-family: inherit; resize: vertical; outline: none;"
            ></textarea>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn-cancel" id="closeMessageModalBtn">H·ªßy</button>
          <button type="button" class="btn-submit" id="sendMessageBtn">G·ª≠i tin nh·∫Øn</button>
        </div>
      </div>
    </div>

    <script>
      // B·∫¢O V·ªÜ TRI·ªÜT ƒê·ªÇ - NgƒÉn main content b·ªã ·∫©n
      (function() {
        // Ch·∫°y ngay l·∫≠p t·ª©c, kh√¥ng ƒë·ª£i DOM
        const protectMain = () => {
          const main = document.querySelector(".main");
          const sidebar = document.querySelector(".sidebar");
          const app = document.querySelector(".app");
          
          if (main) {
            // Override style.display ƒë·ªÉ kh√¥ng bao gi·ªù b·ªã set th√†nh "none"
            const originalSetProperty = CSSStyleDeclaration.prototype.setProperty;
            const mainStyle = main.style;
            
            // B·∫£o v·ªá main element
            Object.defineProperty(mainStyle, 'display', {
              get: function() {
                return this.getPropertyValue('display') || 'flex';
              },
              set: function(value) {
                if (value === 'none') {
                  console.warn('Blocked attempt to hide main content');
                  return; // Kh√¥ng cho ph√©p set th√†nh none
                }
                originalSetProperty.call(this, 'display', value || 'flex');
              },
              configurable: true
            });
            
            // ƒê·∫£m b·∫£o main lu√¥n hi·ªÉn th·ªã
            main.style.setProperty('display', 'flex', 'important');
            main.style.setProperty('flex', '1', 'important');
            main.style.setProperty('visibility', 'visible', 'important');
            main.style.setProperty('opacity', '1', 'important');
            main.style.setProperty('width', 'auto', 'important');
            main.style.setProperty('min-width', '0', 'important');
          }
          
          if (sidebar) {
            sidebar.style.setProperty('display', 'flex', 'important');
            sidebar.style.setProperty('width', '230px', 'important');
            sidebar.style.setProperty('min-width', '230px', 'important');
            sidebar.style.setProperty('visibility', 'visible', 'important');
          }
          
          if (app) {
            app.style.setProperty('display', 'flex', 'important');
            app.style.setProperty('width', '100%', 'important');
            app.style.setProperty('height', '100vh', 'important');
          }
        };
        
        // Ch·∫°y ngay
        protectMain();
        
        // Ch·∫°y khi DOM ready
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", protectMain);
        } else {
          protectMain();
        }
        
        // Ch·∫°y l·∫°i nhi·ªÅu l·∫ßn ƒë·ªÉ ƒë·∫£m b·∫£o
        document.addEventListener("DOMContentLoaded", () => {
          protectMain();
          setTimeout(protectMain, 50);
          setTimeout(protectMain, 100);
          setTimeout(protectMain, 200);
          setTimeout(protectMain, 500);
          setTimeout(protectMain, 1000);
          
          // MutationObserver ƒë·ªÉ t·ª± ƒë·ªông s·ª≠a n·∫øu b·ªã thay ƒë·ªïi
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                protectMain();
              }
            });
          });
          
          const main = document.querySelector(".main");
          const sidebar = document.querySelector(".sidebar");
          const app = document.querySelector(".app");
          
          [main, sidebar, app].forEach(el => {
            if (el) {
              observer.observe(el, {
                attributes: true,
                attributeFilter: ['style', 'class'],
                childList: false,
                subtree: false
              });
            }
          });
          
          // NgƒÉn collapse button
          const collapseBtn = document.querySelector(".collapse-btn");
          if (collapseBtn) {
            collapseBtn.onclick = (e) => {
              e.preventDefault();
              e.stopPropagation();
              protectMain();
              return false;
            };
          }
          
          // Override m·ªçi attempt ƒë·ªÉ ·∫©n main
          const originalQuerySelector = document.querySelector;
          document.querySelector = function(selector) {
            const el = originalQuerySelector.call(this, selector);
            if (el && el.classList && el.classList.contains('main')) {
              // Wrap ƒë·ªÉ b·∫£o v·ªá
              protectMain();
            }
            return el;
          };
        });
        
        // B·∫£o v·ªá khi click v√†o nav-item
        document.addEventListener('click', (e) => {
          const navItem = e.target.closest('.nav-item');
          if (navItem) {
            setTimeout(protectMain, 0);
            setTimeout(protectMain, 10);
            setTimeout(protectMain, 50);
          }
        }, true);
      })();
    </script>
    <script>
      // OVERRIDE TR∆Ø·ªöC KHI C√ÅC SCRIPT KH√ÅC CH·∫†Y
      (function() {
        // Override style.display setter cho main element
        const protectElement = (element, elementName) => {
          if (!element) return;
          
          const originalSetProperty = element.style.setProperty;
          const originalRemoveProperty = element.style.removeProperty;
          
          // Override setProperty
          element.style.setProperty = function(prop, value, priority) {
            if (prop === 'display' && value === 'none') {
              console.warn(`Blocked attempt to hide ${elementName}`);
              return; // Kh√¥ng cho ph√©p ·∫©n
            }
            return originalSetProperty.call(this, prop, value, priority);
          };
          
          // Override removeProperty
          element.style.removeProperty = function(prop) {
            if (prop === 'display') {
              console.warn(`Blocked attempt to remove display from ${elementName}`);
              return false; // Kh√¥ng cho ph√©p x√≥a display
            }
            return originalRemoveProperty.call(this, prop);
          };
          
          // B·∫£o v·ªá display property
          Object.defineProperty(element.style, 'display', {
            get: function() {
              const val = this.getPropertyValue('display');
              return val || 'flex';
            },
            set: function(value) {
              if (value === 'none') {
                console.warn(`Blocked attempt to set display:none on ${elementName}`);
                return;
              }
              this.setProperty('display', value || 'flex', 'important');
            },
            configurable: true
          });
        };
        
        // Ch·∫°y ngay khi c√≥ th·ªÉ
        const runProtection = () => {
          const main = document.querySelector(".main");
          const sidebar = document.querySelector(".sidebar");
          const app = document.querySelector(".app");
          
          if (main) protectElement(main, 'main');
          if (sidebar) protectElement(sidebar, 'sidebar');
          if (app) protectElement(app, 'app');
        };
        
        // Ch·∫°y ngay
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", runProtection);
        } else {
          runProtection();
        }
        
        // Ch·∫°y l·∫°i sau khi DOM s·∫µn s√†ng
        setTimeout(runProtection, 0);
        setTimeout(runProtection, 100);
      })();
    </script>
    <script src="js/scrip.js"></script>
    <script src="js/user-info.js"></script>
    <script src="js/action-menu.js"></script>
    <script src="js/hoantien.js"></script>
    <script src="js/sidebar-preserve.js"></script>
    <script src="js/store-status.js"></script>
    <script>
      // B·∫¢O V·ªÜ SAU KHI T·∫§T C·∫¢ SCRIPT ƒê√É CH·∫†Y
      document.addEventListener("DOMContentLoaded", () => {
        const main = document.querySelector(".main");
        const sidebar = document.querySelector(".sidebar");
        const app = document.querySelector(".app");
        
        // ƒê·∫£m b·∫£o lu√¥n hi·ªÉn th·ªã
        const ensureVisible = () => {
          if (main) {
            if (main.style.display === 'none') main.style.display = 'flex';
            if (main.style.visibility === 'hidden') main.style.visibility = 'visible';
            if (main.style.opacity === '0') main.style.opacity = '1';
          }
          if (sidebar) {
            if (sidebar.style.display === 'none') sidebar.style.display = 'flex';
            if (sidebar.style.visibility === 'hidden') sidebar.style.visibility = 'visible';
          }
          if (app) {
            if (app.style.display === 'none') app.style.display = 'flex';
          }
        };
        
        // Ch·∫°y ngay
        ensureVisible();
        
        // Ch·∫°y ƒë·ªãnh k·ª≥ ƒë·ªÉ ƒë·∫£m b·∫£o
        setInterval(ensureVisible, 500);
        
        // Ch·∫°y khi click v√†o b·∫•t k·ª≥ ƒë√¢u
        document.addEventListener('click', ensureVisible, true);
      });
    </script>
  </body>
</html>

